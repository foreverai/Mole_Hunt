#kivy 1.8.0

<DisplayText@Label>
	font_name: 'Fonts/PressStart2P.ttf'
	bold: True
	font_size: 20	

<DisplayScore@Label> 
	font_name: 'Fonts/PressStart2P.ttf' 
	bold: True      
	font_size: 15
	
<DescriptionText@Label> 
	font_name: 'Fonts/PressStart2P.ttf' 
	text_size: self.size
	valign: 'middle'
	halign: 'center'
	bold: True      
	font_size: 10	

###Having this template gives button behaviour to Image
###Allowing the on_press event to function	
<Character@ButtonBehavior+Image>
	on_press: app.startpopup.charselect.image_select(self)

<TimesUp>
	app: app
		
	BoxLayout:
		orientation: 'vertical'
		size: root.x_size, root.y_size
		center: root.x_center, root.y_center
		DisplayText:
			size_hint: 1, 5
			text: 'Times Up'
		DisplayScore:
			text: 'Score'	
		DisplayScore:
			text: str(root.app.game.databar.score_label)	

<SelectBox>
	startpopup: app.startpopup
	
	canvas:
		Color:
			rgba: 0, 0, 1, 0.3
		Rectangle:
			size: self.size
			pos: self.pos
		Rectangle:
			source: root.img_selectbox
			size: self.size
			pos: self.pos	
			
<CharSelect>
	startpopup: app.startpopup
	selectbox: selectbox_obj
	character1: character1_obj
	
	BoxLayout:	
		size: root.size
		orientation: 'horizontal'
		padding: self.width/40
		RelativeLayout:
			id: character1_obj
			###Selection Box		
			SelectBox:	
				id: selectbox_obj
			Character:
				source: root.character_lst[0]	
		Character:
			source: root.character_lst[1]		

#The 'DASH' overides the automatic popup attributes
<-StartPopUp>
	app: app
	charselect: charselect_obj
				
    size_hint: root.startpopup_size
    auto_dismiss: False  
    			
	BoxLayout:
		size: root.size 
		padding: self.width/75
		orientation: 'vertical'	
		canvas:
			Rectangle:
				source: root.img_startpopup
				size: self.size
				pos: self.pos
		
		###Title & Description	
		BoxLayout:
			orientation: 'vertical'	
			DisplayText:
				text: 'Mole Basher'	
			DescriptionText:
				text: 'Bash your chosen face as many times as possible in the time limit available.'		
		
		###Character Selection	
		RelativeLayout:
			CharSelect:
				id: charselect_obj
		
		###Button
		AnchorLayout:
			size_hint: 1, 0.5
			anchor_x: 'center'
			anchor_y: 'center'	
		    Button:
		    	background_color: 0, 0, 0, 0
		    	size_hint: 0.5, 0.9
		    	font_name: 'Fonts/PressStart2P.ttf' 
		        text: 'Play'
		        on_press: root.start_click()
		        on_press: root.dismiss()  

<-TimeUpPopUp>
	Label:
		text: 'TIME UP'             		 
 
<DataBar>
	game: app.game
	
	canvas:
		Color:
        	rgba: 0.5, 0.957, 0.988, 1
		Rectangle:
        	pos: self.pos
        	size: self.size	
	
	GridLayout:
		size: root.size
		x: 0
		y: root.height * 6     #height is from this widget not the controller widget
		cols: 3
		
		DisplayText:
			text: 'Score'
		DisplayText:
			text: 'High Score'	
		DisplayText:
			text: 'Time'
		
		DisplayScore:
			text: str(root.score_label)								          		
		DisplayScore:
			text: str(root.high_score_label)				
		DisplayScore: 
			text: str(root.time_label)         
				
<Mole>
	game: app.game
	
	kvheight: root.height
	kvwidth: root.width
	
	canvas.before:
		Rectangle:
			source: root.current_char
			pos: self.pos
			
<MoleGame>:
	app: app
	databar: databar_obj
	mole: mole_obj
	gamebox: game_box_obj
	
	kvcenter_x: root.width/2
	kvcenter_y: root.height/2
       
	BoxLayout:
		orientation: 'vertical'
		size: root.size						
					
		###Contains the display labels
		DataBar:
			id: databar_obj	
			size_hint: 1, .1667			

		###Displays the game box
		FloatLayout:	
			id: game_box_obj			
			canvas:
		        Rectangle:
		        	source: root.img_gamebox
		            pos: self.pos
		            size: self.size		    	
		    	             
		    Mole:	
		    	id: mole_obj
		    	size_hint: .15, .2
		    	center_x: root.kvcenter_x
		    	center_y: root.kvcenter_y
