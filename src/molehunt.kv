#kivy 1.8.0
###sp for fonts is kivys reccomended way of scaling text between screen densities

##Main 'time' title	
<DisplayText_1@Label>
	font_name: 'Fonts/PressStart2P.ttf'
	bold: True
	font_size: '18sp'

##time display	
<DisplayScore_1@Label> 
	font_name: 'Fonts/PressStart2P.ttf' 
	bold: True      
	font_size: '14sp'

##Titles e.g. 'score', 'high score'
<DisplayText_2@Label>
	font_name: 'Fonts/PressStart2P.ttf'
	bold: True
	font_size: '12sp'	

##Scores under titles
<DisplayScore_2@Label> 
	font_name: 'Fonts/PressStart2P.ttf' 
	bold: True      
	font_size: '8sp'	

##popup game description text	
<DescriptionText@Label> 
	font_name: 'Fonts/PressStart2P.ttf' 
	text_size: self.size
	valign: 'middle'
	halign: 'center'
	bold: True      
	font_size: '8sp'

###Character selection class
#Having this template gives button behaviour to Image
#Allowing the on_press event to function	
<Character@ButtonBehavior+Image>
	on_press: app.startpopup.charselect.image_select(self)
	
###Medal class
<Medal@Image>	

<TimesUp>
	app: app
		
	BoxLayout:
		orientation: 'vertical'
		size: root.x_size, root.y_size
		center: root.x_center, root.y_center
		DisplayText_1:
			size_hint: 1, 5
			text: 'Times Up'
		DisplayScore_1:
			text: 'Score'	
		DisplayScore_1:
			text: str(root.app.game.databar.score_label)	

<Achievements>
	startpopup: app.startpopup
	
	###Achievement medals				
	GridLayout:	
		size: root.size
		cols: 4
		padding: sp(2)
		Medal:
			source: root.medal_1
		Medal:
			source: root.medal_2
		Medal:
			source: root.medal_3
		Medal:	
			source: root.medal_4

<SelectBox>
	startpopup: app.startpopup
	
	BoxLayout:
		center: root.x_center, root.y_center
		size: root.x_width, root.y_height
		canvas:
			Rectangle:
				source: 'Images/selectbox.png'
				size: self.size
				pos: self.pos	
				
<CharSelect>
	startpopup: app.startpopup
	selectbox: selectbox_obj
	character1: character1_obj
	
	###Selection Box		
	SelectBox:
		id: selectbox_obj	
	
	###Characters
	GridLayout:	
		size: root.size
		cols: root.char_columns
		padding: sp(25)
		Character:
			id: character1_obj
			source: root.character_lst[0]	
		Character:
			source: root.character_lst[1]		

#The 'DASH' overides the automatic popup attributes
<-StartPopUp>
	app: app
	charselect: charselect_obj
	achievements: achievements_obj
				
    size_hint: root.startpopup_size
    auto_dismiss: False  
    
    BoxLayout:
    	size: root.size
    	orientation: 'vertical'
    	
    	###Main popup			
		BoxLayout: 
			padding: sp(2)
			orientation: 'vertical'	
			
			canvas:
				Rectangle:
					source: 'Images/popup.png'
					size: self.size
					pos: self.pos
			
			###Title & Description	
			BoxLayout:
				orientation: 'vertical'	
				DisplayText_2:
					text: 'Mole Basher'	
				DescriptionText:
					text: 'Bash your chosen face as many times as possible in the time limit available.'
				DescriptionText:
					text: 'Character Selection'
					color: 1, 1, 0.5, 1 			
			
			###Character Selection	
			RelativeLayout:
				CharSelect:
					id: charselect_obj
			
			###Button
			AnchorLayout:
				size_hint: 1, 0.5
				anchor_x: 'center'
				anchor_y: 'center'	
			    Button:
			    	background_color: 0, 0, 0, 0
			    	size_hint: 0.5, 0.9
			    	font_name: 'Fonts/PressStart2P.ttf'
			    	color: 1, 0.5, 0.5, 1 
			        text: 'Play'
			        on_press: root.start_click()
			        on_press: root.dismiss() 
			        
		###Achievements board
		RelativeLayout:
			size_hint: 1, 0.25
			Achievements: 
				id: achievements_obj
 
<DataBar>
	game: app.game
	
	canvas:
		Rectangle:
			source: 'Images/databar.png'
        	pos: self.pos
        	size: self.size	
	
	BoxLayout:
		size: root.size
		y: root.height * 6    #root.height is from this widget not the controller widget
		orientation: 'horizontal'
		
		BoxLayout:
			orientation: 'vertical'
			DisplayText_2:
				text: 'Score'	
			DisplayScore_2:
				text: str(root.score_label)	
			BoxLayout:
				size_hint: 1, 1.5       #Creates a blank box below the text in effect pushing the text up
				
		BoxLayout:
			orientation: 'vertical'		
			DisplayText_1:
				text: 'Time'
			DisplayScore_1: 
				text: str(root.time_label)
				
		BoxLayout:
			orientation: 'vertical'	
			DisplayText_2:
				text: 'High Score'								          						
			DisplayScore_2:
				text: str(root.high_score_label)	
			BoxLayout:
				size_hint: 1, 1.5	         
				
<Mole>
	game: app.game
	
	canvas.before:
		Rectangle:
			source: 'Images/mole.png'
			size: sp(self.mole_width), sp(self.mole_height)
			pos: self.pos
			
<MoleGame>:
	app: app
	databar: databar_obj
	mole: mole_obj
	gamebox: game_box_obj
       
	BoxLayout:
		orientation: 'vertical'
		size: root.size						
					
		###Contains the display labels
		DataBar:
			id: databar_obj	
			size_hint: 1, 0.1667	# 1 / the databar size multiplier

		###Displays the game box
		FloatLayout:	
			id: game_box_obj			
			canvas:
		        Rectangle:
		        	source: 'Images/gamebox.png'
		            pos: self.pos
		            size: self.size		    	
		    	             
		    Mole:	
		    	id: mole_obj
		    	center_x: root.width/2
		    	center_y: root.height/2
